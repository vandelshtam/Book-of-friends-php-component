# book-of-friends-php-component
## 1. О проекте
Проект выполнен на языке php  c применением готовых компонентов с packagist.org https://packagist.org/

### Название проекта "Book of friends" (примечание: название не совпадает с названием папки проекта)

В этом проекте реализован примитивный web-сайт  социального сообщества. Сайт имеет один раздел:

- Раздел "Пользователи".

## 2. Краткое описание функциональных возможностей сайта

### Раздел "Пользователи" - главная страница
В разделе пользователи выполняется функционал по регистрации и редактирования данных пользователей, выводится информация о всех пользователях. Показываются профили пользователей.
В этом разделе авторизованные пользователи имеют возможность:
- регистрироваться.
- редактировать свои данные(аватар,контактные данные,информацию о себе).
- удалить свой профиль.
- редактировать свои данные безопасности(имя,email- он же "логин",пароль).
- просматривать свой профиль и профили зарегистрированных пользователей.
- изменять свой статус присутствия(онлайн, недоступен, отошел).
- подтверждение регистрации и верификации производится с использованием отправки электронного письма на адрес пользователя.

 Пользователь с правом "admin" имеет все выше перечисленные возможности, но по отношению к любому пользователю, в том числе создавать профили новых пользователей.
 Пользователь с правом (ролью) 'admin',  имеет возможность наделять/отзывать у других пользователей роль 'admin'. 
 Пользователь с ролью 'superadmin' имеет привилегии  как у  'admin'.
 Пользователей с ролями "admin", 'superadmin' удалить незльзя, но если вы измените им роль, то можете их удалить. Принимайте это во внимание чтобы случайно не удалить их!
 Чтобы защитить изменение ролей рользователя "admin", 'superadmin' и тем самым предотваратить удаление, в поле таблицы БД 'role' нужно установить значение 1.

Не авторизованные пользователи могут посещать только:
- главную страницу раздел "Пользователи".
- страницу регистрации.
- страницу авторизации.
На главной странице, не авторизованным пользователям доступен просмотр списка пользователей с ограниченной информацией о них.
 

## 3. Краткая документация к проекту

### Проект реализован на языке PHP в стиле 'mvc' и ООП c применением готовых компонентов

#### Важные файлы проекта

#### Таблицы в БД 
В проекте созданы  таблицы:
- Users в которой содержиться вся необходимая информация о пользователях(name, email, password и т п). Создается при помощи компонента 'delight-im'.


#### Дерриктория App
##### Дерриктория App/views
Файлы видов, ситлей, медиа

##### Дерриктория App/model
Классы моделей обработки и действий

##### Дерриктория App/Controllers
В папке содержатся файлы Контроллеров.Все действия связанные с  пользователями и их ресурсами производятся в данной дерриктории.

##### 'App/controllers/UserControllers.php' этот файл (класс) выполняет:
- регистрацию пользователей.
- авторизацию пользователей.
- смену информации безопасности пользователей(смена почты, смена пароля, смена имени).
- выход из системы.
- повторное подтверждение пароля при выполнении важных действий.
-удаление пользователя.

##### 'App/controllers/HomeControllers.php' в этом классе выполняются следующие действия:
- вывод страниц со списком пользователей, вывод страницы профиля пользователей и их поиск.
- страница профиля пользователя.
- вывод страницы и выполнение изменения статуса присутсвия пользователя на сайте.
- вывод страницы и изменение аватара пользователя.

##### Дерриктория public
index.php - в нем записаны правила маршрутизации запросов, конфигурация подключения к БД, composer.json в котором внесены загруженные компоненты.

##### Дерриктория app/vendor 
содержит файлы компонентов, автолоудинга и др

###### /views/layouts/
- custom_auth.php - шаблон вида для подключения файлов создания страниц подключаемых контроллером Auth.
- custom_chats.php  - шаблон вида для файлов создания страниц подключаемых контроллером Chats.
- custom_openChat.php - шаблон вида для подключения файлов  страниц подключаемых контроллером Chats но для показа страниц откытия чата.
- custom_posts.php  - шаблон вида для файлов создания страниц подключаемых контроллером Chats.
- default.php - шаблон по умолчанию, используется для главной страницы и всех страниц раздела "Пользователи".

## 4. Краткая инструкция для развертывания проекта у себя

### Размещение проекта

Скопируйте проект из репозитория  github и разместите у себя в папке веб-сервера

Если вам потребуется использовать дополнительные компоненты или провести миграцию таблиц, 
установите в папке проекта "composer" https://getcomposer.org/ и устанавливате необходимые для вас компоненты.
### Проект настроен для работы на  веб-сервере  Apache
Для развертывания проекта понадобиться провести настройки окружения.
Если ваш сервер Apache  в файле App/public/index.php нужно внести свои параметры конфигурации подключения к БД

 - PDO::class => function(){
    - $driver = 'mysql'; 
    - $host = '........'; // записать имя вашего сервера
    - $database_name = '........';// вписать имя вашей таблицы
    - $username = '........'; // вписать ваше имя пользователя phpMyAdmin
    - $password = '.......'; // вписать ваш пароль от phpMyAdmin
    - return new PDO("$driver:host=$host; dbname=$database_name; charset=utf8;",$username,$password);

    
Если у вас другой веб-сервер, потребуются другие настройки конфигурации подключения.


### Если ваш веб-сервер Apache в папке в которой размещена папка проекта разместите файл .htaccess
В файле запишите код:

- AddDefaultCharset utf-8

- RewriteEngine On

- RewriteRule (.*) lesson-project-php-mvc/public/$1 


### В проете для отправки электронных писем подключен почтовый сервис для разработчиков. 
Вам необходимо подключить свой почтовый сервер в файле app/model/MailBuilder.php для чего измените настройки конфигурации подключения сервера.



### В проекте приложен файл exampdb.sql из которого можно импортировать таблицы БД
В таблице БД имеются пользователи проекта с установленными ролями "admin" и "superadmin:
- otto@mail.ru/ username 'Otto';
- vlad@mail.ru/ username 'Vlad';
- ivan@gmail.com/ username 'Ivan';
- vlada@gmail.com/ username 'Vlada';
- vandel@gmail.com/ username 'Vandel';
- slava@gmail.com/ username 'Slava';

Пароль у всех  пользователей 123aaa.
Все имеют роль 'admin'.

Пользователи :
- otto@mail.ru/ username 'Otto';
- vlad@mail.ru/ username 'Vlad';
- ivan@gmail.com/ username 'Ivan';
в поле таблицы 'role' имеют значение 1, защита от изменения роли и удаления

Экспортируйте  данные из файла exampdb.aql в phpMyAdmin.

Спасибо за прочтение файла! Желаю всем успехов!

